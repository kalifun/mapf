ECBS（Enhanced Conflict-Based Search，增强冲突搜索）是一种用于 **多智能体路径规划（Multi-Agent Path Finding, MAPF）** 的高级算法。

## 概述

ECBS 算法结合了 CBS 的冲突解决机制和 focal search（焦点搜索） 技术，通过引入次优路径规划来优化搜索过程。

## 思想

基于`CBS` 两层的概念中引入了 `forcal search` 技术来优化搜索。

## 定义

1. **CBS**  
   CBS 是一种分层算法，通过在高层次解决智能体之间的冲突来规划路径。它维护一个**约束树（Constraint Tree, CT）**，每个节点包含一组路径和约束条件。CBS 通过搜索约束树，逐步添加约束来消除冲突，直到找到无冲突的路径。

2. **Focal Search**  
   ECBS 在 CBS 的基础上引入了 focal search，这是一种启发式搜索技术。Focal search 不仅关注节点的 **f 值（f = g + h，其中 g 是已知成本，h 是启发式估计）**，还优先探索一个 **focal list** 中的节点。Focal list 通常包含 f 值不超过最优 f 值某个倍数的节点。这种方法使 ECBS 能够更智能地选择搜索方向。

3. **高层次搜索**  
   在高层次，ECBS 使用 focal search 来选择约束树中的节点进行扩展。选择节点时，除了考虑 f 值（通常是所有路径成本的总和），还会结合冲突数量等启发式指标，优先扩展那些更有可能快速解决冲突的节点。

4. **低层次搜索**  
   在低层次，ECBS 为每个智能体规划路径时，也使用 focal search。与 CBS 要求最优路径不同，ECBS 允许路径成本在最优路径成本的某个倍数（例如 1 + ε）内。这种次优路径的接受显著减少了搜索时间。

5. **冲突解决**  
   当检测到智能体之间的冲突时，ECBS 在高层次通过添加约束来解决问题。例如，约束可能禁止某个智能体在特定时间经过某个位置。ECBS 可能会优先选择影响更多智能体的冲突来解决，以加速搜索过程。

6. **次优性参数 ε**  
   ECBS 引入了一个关键参数 **ε**，用于控制解的次优性。用户可以调整 ε 来平衡路径质量和搜索时间：
   - **较小的 ε**：路径更接近最优解，但搜索时间较长。
   - **较大的 ε**：搜索更快，但路径质量可能较低。